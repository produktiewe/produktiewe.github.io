window.addEventListener("load",function(){var P=function(){return parseInt(Date.now()+10*Math.random()+1)},J=function(a){a/=1E3;var c=parseInt(a/60/60),b=parseInt(a/60%60);a=parseInt(a%60);return{hour:c,minute:b,second:a}},Q=function(a,c){var b=c-a;console.assert(0<=b,b);return J(b)},v=function(a){a=a.toString();return 1===a.length?"0"+a:a},w=function(a){return JSON.parse(JSON.stringify(a))},t=null,x={},y={},R={1:{id:1,title:"Todo",createdDate:Date.now(),tasks:[]}},Y={1:{id:1,title:"General Board",
createdDate:Date.now(),panels:[1]}},K={modelSettings:{id:"modelSettings",modifiedModel:null,lastModified:Date.now()},timerSettings:{id:"timerSettings",timeLogId:null,taskId:null}},k=document.getElementsByClassName("content-body")[0],Z=k.getElementsByClassName("template-board")[0],aa=k.getElementsByClassName("template-panel")[0],ba=k.getElementsByClassName("template-task")[0],ca=k.getElementsByClassName("template-sub-task")[0],da=k.getElementsByClassName("template-timer")[0],ea=k.getElementsByClassName("template-timelog-panel")[0],
fa=k.getElementsByClassName("template-timelog-session-day")[0],ha=k.getElementsByClassName("template-timelog-session-hour")[0];k.removeChild(Z);k.removeChild(aa);k.removeChild(ba);k.removeChild(ca);k.removeChild(da);k.removeChild(ea);k.removeChild(fa);k.removeChild(ha);var H=Object.freeze({task:"task",subTask:"sub-task"}),F=Object.freeze({timerSettingsId:"timerSettings",modelSettingsId:"modelSettings"}),h=Object.freeze({taskStorageId:"task.json",timelogStorageId:"timelog.json",settingStorageId:"setting.json",
boardStorageId:"board.json",panelStorageId:"panel.json"}),l=Object.freeze({OnAll:"all",OnEdit:"edit",OnRemove:"remove",OnAdd:"add"}),va=function(){var a=null,c=function(){return utils.parseQueryString(window.location.hash).access_token},b=function(b){a.filesListFolder({path:""}).then(function(a){a=a.entries;var d=a.length,e=document.getElementById("files");a.forEach(function(a){var f=document.createElement("li");f.innerHTML=a.name;e.appendChild(f);a='{"path": "/'+a.name+'"}';$.ajax({url:"https://content.dropboxapi.com/2/files/download",
type:"POST",dataType:"json",headers:{Authorization:"Bearer "+c(),"Dropbox-API-Arg":a}}).done(function(a){console.log(a);null==t&&(t={});"task.json"===a.filename?(t["task.json"]=a,y=a.content):"timelog.json"===a.filename?(t["timelog.json"]=a,x=a.content):"setting.json"===a.filename?(t["setting.json"]=a,K=a.content):"board.json"===a.filename?(t["board.json"]=a,Y=a.content):"panel.json"===a.filename&&(t["panel.json"]=a,R=a.content);--d;0==d&&(u(),b&&b(!0))}).fail(function(a){console.log("error",a);b&&
b(!1)})})})["catch"](function(a){console.error(a)})},d=function(b,c,e){console.assert(-1<Object.values(h).indexOf(b));var f="/"+b,g=JSON.stringify(c);a.filesUpload({path:f,contents:g,mode:"overwrite"}).then(function(a){console.log(a);e&&e(!0)})["catch"](function(a){console.log(a);console.log("retrying.......");setTimeout(function(){d(b,c,e)},2E3)})},e=function(a,b){var c=!0;null==t?c=!1:Object.values(t).length!=Object.values(h).length&&(c=!1);1==c?d(a,t[a],b):b&&b(!1)};if(c())document.getElementById("authed-section").style.display=
"block",a=new Dropbox.Dropbox({accessToken:c()}),b();else{document.getElementById("pre-auth-section").style.display="block";a=new Dropbox.Dropbox({clientId:"1xc4d9cf123830a"});var f=a.getAuthenticationUrl("https://produktiewe.github.io/");document.getElementById("authlink").href=f}var g=function(a,b){var c=Object.values(h),d=c[a];a<c.length?(a+=1,e(d,function(c){c?console.log("remote file updated successfully --\x3e",d):console.log("remote update failed --\x3e",d);g(a,b)})):b&&b()};return{UpdateLocalStorage:b,
UpdateRemoteStorage:e,UpdateAllRemoteStorage:g}}(),D=function(){var a=null,c=null,b=null,d=null,e=null,f=0,g=function(a,b){b===l.OnEdit&&G(a.timelog,C,0,function(b){console.log("timerstate updated");c=a;d=b;f=M(b)})},p=function(a){I(F.timerSettingsId,function(b){b||console.log("no timer settings found!");a&&a(b)})},S=function(){if(a&&c&&b&&e&&d){var g=b.getElementsByClassName("timer-task-title")[0],p=b.getElementsByClassName("timer-task-session-time")[0],wa=b.getElementsByClassName("timer-task-total-time")[0],
h=Date.now(),k=a.startTimeStamp,n=Q(k,h);h=J(f+(h-k));g.innerText=c.title;p.innerText=n.hour.toString()+":"+n.minute.toString()+":"+n.second.toString();wa.innerText=h.hour.toString()+":"+h.minute.toString()+":"+h.second.toString();setTimeout(S,200)}},m=function(p,r){console.assert(p);console.assert(r);console.assert(null===a);console.assert(null===c);console.assert(null===d);console.assert(null===e);var ua=r.id;z(F.timerSettingsId,"taskId",p.id,I,N,function(e){e?(console.log("taskId added to app settings successfully"),
z(F.timerSettingsId,"timeLogId",ua,I,N,function(e){e?(console.log("timeLogId added to app settings successfully"),G(p.timelog,C,0,function(e){b=xa(p);a=r;c=p;d=e;f=M(e);k.appendChild(b);setTimeout(S,200)})):(console.log("timeLogId added to app settings failed!"),n())})):(console.log("taskId added to app settings failed!"),n())});e=ya(h.taskStorageId,l.OnAll,g)},L=function(){var b=Date.now();clearTimeout(S);z(a.id,"endTimeStamp",b,C,za,function(a){a?(console.log("set endTimeStamp success!"),n(),u()):
console.log("set endTimeStamp faield!")})},n=function(){z(F.timerSettingsId,"timeLogId",null,I,N,function(a){a?console.log("timeLogId - cleaned sucess!"):console.log("timeLogId - cleaned failed!")});z(F.timerSettingsId,"taskId",null,I,N,function(a){a?console.log("taskId - cleaned sucess!"):console.log("taskId - cleaned failed!")});e&&(Aa(h.taskStorageId,e),e=null);b&&k.contains(b)&&k.removeChild(b);d=b=c=a=null;f=0};return{InitTimer:function(){b&&k.removeChild(b);p(function(a){a?a.taskId&&a.timeLogId?
ia([a.taskId,a.timeLogId],[q,C],null,0,function(a){var b=a[0];a=a[1];b&&a?m(b,a):n()}):(a.taskId||a.timeLogId)&&n():console.log("error timerSettings not found!")})},StartTimer:function(a,b){m(a,b)},StopTimer:function(){L()},IsRunning:function(a){p(function(b){b?a&&a(b.timeLogId&&b.taskId):a&&a(!1)})}}}(),E=Object.freeze(function(){var a={};a[h.taskStorageId]=[];a[h.timelogStorageId]=[];a[h.settingStorageId]=[];a[h.boardStorageId]=[];a[h.panelStorageId]=[];return a}()),Aa=function(a,c){console.assert(E);
console.assert(-1<Object.values(h).indexOf(a));var b=E[a];console.assert(b instanceof Array);for(var d=0;d<b.length;)c===b[d].id?(b.splice(d,1),d=0):d+=1},ya=function(a,c,b){console.assert(E);console.assert(-1<Object.values(h).indexOf(a));console.assert(-1<Object.values(l).indexOf(c));console.assert("function"===typeof b);var d=P();E[a].push({id:d,eventType:c,remoteStorageId:a,cb:b});return d},A=function(a,c,b){console.assert(E);console.assert(-1<Object.values(h).indexOf(a));console.assert(-1<Object.values(l).indexOf(c));
va.UpdateRemoteStorage(a,function(b){b?console.log("remote storage updated successfully --\x3e",a):console.log("remote storage updated failed --\x3e",a)});setTimeout(function(){console.assert(E);console.assert(-1<Object.values(h).indexOf(a));console.assert(-1<Object.values(l).indexOf(c));var d=E[a];console.assert(d instanceof Array);for(var e=0;e<d.length;e++){var f=d[e];f.eventType!==c&&f.eventType!==l.OnAll||f.cb(b,c)}},2)},G=function(a,c,b,d,e){console.assert(Number.isInteger(b));console.assert(a instanceof
Array);console.assert("function"===typeof c);e instanceof Array||(e=[]);b<a.length?c(a[b],function(f){e.push(f);b+=1;G(a,c,b,d,e)}):d&&d(e)},ia=function(a,c,b,d,e){console.assert(Number.isInteger(d));console.assert(a instanceof Array);console.assert(c instanceof Array);console.assert(a.length==c.length);b instanceof Array||(b=[]);if(d<a.length)(0,c[d])(a[d],function(f){b.push(f);d+=1;ia(a,c,b,d,e)});else e(b)},ja=function(a,c){console.assert(a instanceof Array);console.assert("function"===typeof c);
for(var b=0;b<a.length;b++)c(a[b])},T=function(a,c,b,d,e,f){console.assert("string"===typeof c);console.assert("function"===typeof d);console.assert("function"===typeof e);d(a,function(a){if(a){console.assert(a[c]instanceof Array);var d=a[c],g=d.indexOf(b);-1<g&&d.splice(g,1);e(a,function(a){f&&f(a)})}else f&&f(!1)})},U=function(a,c,b,d,e,f){console.assert("string"===typeof c);console.assert("function"===typeof d);console.assert("function"===typeof e);d(a,function(a){a?(console.assert(a[c]instanceof
Array),a[c].push(b),e(a,function(a){f&&f(a)})):f&&f(!1)})},z=function(a,c,b,d,e,f){console.assert("string"===typeof c);console.assert("function"===typeof d);console.assert("function"===typeof e);d(a,function(a){a?(console.assert(c in a),a[c]=b,e(a,function(a){f&&f(a)})):f&&f(!1)})},I=function(a,c){console.assert(-1<Object.values(F).indexOf(a));var b=w(K[a]);c&&c(b)},N=function(a,c){K[a.id]=w(a);c&&c(!0);A(h.settingStorageId,l.OnEdit,K[a.id])},Ba=function(a,c){var b=w(Y[a]);c&&c(b)},q=function(a,c){var b=
w(y[a]);c&&c(b)},V=function(a,c){q(a,function(b){b.type===H.task&&(ja(b.timelog,ka),ja(b.subtasks,V));delete y[a];c&&c(!0);A(h.taskStorageId,l.OnRemove,!0)})},B=function(a,c){null===a.doneDate&&1==a.done?a.doneDate=Date.now():(a.doneDate=null,a.done=!1);y[a.id]=w(a);c&&c(!0);A(h.taskStorageId,l.OnEdit,y[a.id])},Ca=function(a,c){la(a,H.subTask,function(a){c&&c(a)})},Da=function(a,c){la(a,H.task,function(a){c&&c(a)})},la=function(a,c,b){console.assert(-1<Object.values(H).indexOf(c));console.assert(a);
var d=P();a={id:d,title:a,done:!1,doneDate:null,type:c,createdDate:Date.now(),timelog:[],subtasks:[]};c==H.subTask&&delete a.subtasks;y[d]=a;b&&b(y[d]);A(h.taskStorageId,l.OnAdd,y[d])},C=function(a,c){var b=w(x[a]);c&&c(b)},ka=function(a,c){delete x[a];c&&c(!0);A(h.timelogStorageId,l.OnRemove,!0)},za=function(a,c){var b=a.startTimeStamp,d=a.endTimeStamp;d&&b&&(a.duration=Q(b,d));x[a.id]=w(a);c&&c(!0);A(h.timelogStorageId,l.OnEdit,x[a.id])},Ea=function(a,c,b){var d=P(),e=null;b&&(e=b);x[d]={id:d,startTimeStamp:a,
endTimeStamp:e,duration:null};c&&c(x[d]);A(h.timelogStorageId,l.OnAdd,x[d])},Fa=function(a){var c={},b=[];a.sort(function(a,b){return b.startTimeStamp-a.startTimeStamp});for(var d=0;d<a.length;++d){var e=a[d],f=(new Date(Date.now())).toDateString(),g=(new Date(e.startTimeStamp)).toDateString();f=g===f?"Today":g;f in c?c[f].push(e):(c[f]=[e],b.push({date:f,timeLogObjArr:c[f]}))}return b},Ga=function(a,c,b,d){var e="validated";if(b>c){for(d=0;d<a.length;++d){var f=a[d];if(f.startTimeStamp<b&&f.endTimeStamp>
b||f.startTimeStamp<c&&f.endTimeStamp>c||c<f.endTimeStamp&&b>f.endTimeStamp||c<f.startTimeStamp&&b>f.startTimeStamp)e=new Date(f.endTimeStamp),e=(new Date(f.startTimeStamp)).toLocaleString()+" - "+e.toLocaleString()+"\n"}"validated"!=e&&(e="Conflict with: "+e)}else e="End time must be greater than start time.";return e},M=function(a){console.assert(a instanceof Array);for(var c=0,b=0;b<a.length;b++){var d=a[b],e=d.startTimeStamp;d=d.endTimeStamp;null!=d&&(e=d-e,console.assert(0<=e),c+=e)}return c},
ma=function(a,c){R[a.id]=a;c&&c(!0);A(h.panelStorageId,l.OnEdit,!0)},W=function(a,c){var b=w(R[a]);c&&c(b)},na=function(a,c,b,d){Ea(a,function(a){a?(console.log("timelog creation success"),U(b,"timelog",a.id,q,B,function(b){b?(console.log("timelog added to task successfully!"),d&&d(a)):(console.log("timelog added to task failed!"),d&&d(null))})):(console.log("timelog creation failed!"),d&&d(null))},c)},Ha=function(a){var c=a.taskObj.id;T(a.panelId,"tasks",c,W,ma,function(a){a?(console.log("edit panel success"),
V(c,function(a){a?console.log("task remove success!"):console.log("task remove failed!");u()})):(console.log("edit panel failed"),u())})},pa=function(a){var c=a.taskObj.id,b=a.htmlRef.inpSubTasktitle.value,d=a.htmlRef.taskNode.getElementsByClassName("list-sub-tasks")[0];b&&""!=b&&Ca(b,function(b){b?U(c,"subtasks",b.id,q,B,function(e){e?(e=oa(b,c),d.appendChild(e),a.htmlRef.inpSubTasktitle.value="",console.log("edit task to add subtask success")):console.log("edit task to add subtask failed!")}):console.log("add subtask failed")})},
qa=function(a){var c=a.taskObj;a=a.htmlRef.inpTaskTitle;c.title!=a.value&&""!=a.value&&z(c.id,"title",a.value,q,B,function(a){a?console.log("edit task title success!"):console.log("edit task title failed!")});""==a.value&&(a.value=c.title);a.disabled=!0},Ia=function(a){z(a.taskObj.id,"done",a.htmlRef.inpTaskDoneChkbox.checked,q,B,function(a){a?console.log("checked task success!"):console.log("checked task failed!")})},Ja=function(a){var c=a.id;D.IsRunning(function(b){b?console.log("A timer is already running, can't start more than one timer at one time!"):
(b=Date.now(),na(b,null,c,function(b){b?D.StartTimer(a,b):console.assert(!1)}))})},X=function(a){q(a.taskObj.id,function(a){a&&D.IsRunning(function(b){b?alert("Cannot view Time Log while timer is still running!"):(b=Ka(a),La("Task: "+a.title,b).ShowModal())})})},Ma=function(a){var c=a.subTaskObj.id;T(a.taskId,"subtasks",c,q,B,function(a){a?(console.log("edit task successful!"),V(c,function(a){a?console.log("remove subtask successful!"):console.log("remove subtask failed!");u()})):(u(),console.log("edit task failed!"))})},
Na=function(a){var c=a.htmlRef.inpSubtaskDoneCheck.checked;q(a.subTaskObj.id,function(a){a.done=c;B(a,function(a){a?console.log("checked subtask success!"):console.log("checked subtask failed!")})})},ra=function(a){var c=a.subTaskObj;a=a.htmlRef.inpSubtaskTitle;c.title!=a.value&&""!=a.value&&z(c.id,"title",a.value,q,B,function(a){a?console.log("edit sub task title success!"):console.log("edit sub task failed!")});""==a.value&&(a.value=c.title);a.disabled=!0},ta=function(a){var c=a.htmlRef.inpAddTask.value,
b=a.htmlRef.panelNode.getElementsByClassName("list-tasks")[0],d=a.panelObj.id;""!=c&&null!=c&&Da(c,function(c){console.assert(c);U(d,"tasks",c.id,W,ma,function(e){e?(e=sa(c,d),b.appendChild(e),a.htmlRef.inpAddTask.value="",console.log("add task successful!")):console.log("add task failed!")})})},Oa=function(a){var c=a.taskObj,b=a.htmlRef.fromTimePicker,d=a.htmlRef.toTimePicker,e=a.htmlRef.datePicker.value.split("-");b=b.value.split(":");d=d.value.split(":");var f=new Date;f.setYear(e[0]);f.setMonth(e[1]-
1);f.setDate(e[2]);f.setHours(b[0]);f.setMinutes(b[1]);b[2]&&f.setSeconds(b[2]);f=f.valueOf();var g=new Date;g.setYear(e[0]);g.setMonth(e[1]-1);g.setDate(e[2]);g.setHours(d[0]);g.setMinutes(d[1]);d[2]&&g.setSeconds(d[2]);g=g.valueOf();G(c.timelog,C,0,function(b){b?(b=Ga(b,f,g),"validated"===b?na(f,g,c.id,function(b){b&&(u(),X(a))}):alert(b)):console.log("Add new timelog failed!")})},Pa=function(a){var c=a.timeLogObj,b=a.taskObj;ka(c.id,function(d){d?(console.log("timelog remove success!"),T(b.id,
"timelog",c.id,q,B,function(b){b?(console.log("timelog id removed from task success!"),u(),X(a)):console.assert(!1)})):console.log("timelog remove failed!")})},Sa=function(a,c){var b=null;Ba(a,function(d){if(d){b=Qa(d);for(var e=0;e<d.panels.length;e++)Ra(d.panels[e],a,function(a){a?b.appendChild(a):console.assert(!1)})}c&&c(b)})},Ra=function(a,c,b){var d=null,e=null;W(a,function(f){if(f){d=Ta(f,c);e=d.getElementsByClassName("list-tasks")[0];for(var g=0;g<f.tasks.length;g++)Ua(f.tasks[g],a,function(a){a?
e.appendChild(a):console.assert(!1)})}b&&b(d)})},Ua=function(a,c,b){var d=null,e=null;q(a,function(f){if(f){d=sa(f,c);e=d.getElementsByClassName("list-sub-tasks")[0];for(var g=0;g<f.subtasks.length;g++)Va(f.subtasks[g],a,function(a){a?e.appendChild(a):console.assert(!1)})}b&&b(d)})},Va=function(a,c,b){var d=null;q(a,function(a){a&&(d=oa(a,c));b&&b(d)})},Qa=function(a){var c=Z.cloneNode(!0),b=c.getElementsByClassName("title-board")[0],d=c.getElementsByClassName("btn-add-panel")[0];c.getElementsByClassName("input-add-panel");
b.innerText=a.title;d.addEventListener("click",function(a){});return c},Ta=function(a,c){var b=aa.cloneNode(!0),d=b.getElementsByClassName("title-panel")[0],e=b.getElementsByClassName("btn-add-task")[0],f=b.getElementsByClassName("input-add-task")[0],g=b.getElementsByClassName("btn-remove-panel")[0];d.innerText=a.title;var h={panelObj:a,boardId:c,htmlRef:{panelNode:b,title:d,inpAddTask:f,btnRemovePanel:g}};document.addEventListener("keypress",function(a){13===event.keyCode&&document.activeElement===
f&&ta(h)});e.addEventListener("click",function(a){ta(h)});g.addEventListener("click",function(a){});return b},sa=function(a,c){var b=ba.cloneNode(!0),d=b.getElementsByClassName("btn-move-task")[0],e=b.getElementsByClassName("btn-remove-task")[0],f=b.getElementsByClassName("btn-add-subtask")[0],g=b.getElementsByClassName("btn-start-timer")[0],h=b.getElementsByClassName("btn-open-timelog")[0],k=b.getElementsByClassName("input-task-checkbox-done")[0],m=b.getElementsByClassName("input-task-title")[0],
L=b.getElementsByClassName("input-subtask-title")[0],n=b.getElementsByClassName("span-total-time")[0],l=b.getElementsByClassName("span-on-going-timer")[0];m.value=a.title;k.checked=a.done;G(a.timelog,C,0,function(a){a&&(a=M(a),a=J(a),n.innerText=a.hour+"hr "+a.minute+"m")});var r={taskObj:a,panelId:c,htmlRef:{taskNode:b,btnMoveTask:d,btnRemoveTask:e,btnAddSubTask:f,btnStartTimer:g,btnAddCustomTime:h,inpTaskDoneChkbox:k,inpTaskTitle:m,inpSubTasktitle:L,sTotalTime:n,sOnGoingTime:l}};document.addEventListener("keypress",
function(a){13===event.keyCode&&document.activeElement===L&&pa(r);13===event.keyCode&&document.activeElement===m&&qa(r)});document.addEventListener("click",function(a){event.target===m?m.disabled=!1:(m.disabled=!0,qa(r))});d.addEventListener("click",function(a){});e.addEventListener("click",function(a){D.IsRunning(function(a){a?alert("Cannot remove task while timer is running!"):confirm("Are you sure you want to remove this task?")&&Ha(r)})});f.addEventListener("click",function(a){pa(r)});g.addEventListener("click",
function(b){Ja(a)});h.addEventListener("click",function(a){X(r)});k.addEventListener("click",function(a){Ia(r)});return b},oa=function(a,c){var b=ca.cloneNode(!0),d=b.getElementsByClassName("btn-remove-subtask")[0],e=b.getElementsByClassName("input-subtask-checkbox-done")[0],f=b.getElementsByClassName("input-subtask-title")[0];f.value=a.title;e.checked=a.done;var g={subTaskObj:a,taskId:c,htmlRef:{subTaskNode:b,btnRemoveSubtask:d,inpSubtaskDoneCheck:e,inpSubtaskTitle:f}};document.addEventListener("keypress",
function(a){13===event.keyCode&&document.activeElement===f&&ra(g)});document.addEventListener("click",function(a){event.target===f?f.disabled=!1:(f.disabled=!0,ra(g))});d.addEventListener("click",function(a){D.IsRunning(function(a){a?alert("Cannot remove sub task while timer is running!"):confirm("Are you sure you want to remove this sub-task?")&&Ma(g)})});e.addEventListener("click",function(a){Na(g)});return b},xa=function(a){a=da.cloneNode(!0);a.getElementsByClassName("timer-task-title");a.getElementsByClassName("timer-task-session-time");
a.getElementsByClassName("timer-task-total-time");a.getElementsByClassName("btn-stop-timer")[0].addEventListener("click",function(a){D.StopTimer()});return a},Ka=function(a){var c=ea.cloneNode(!0),b=c.getElementsByClassName("list-day")[0],d=c.getElementsByClassName("btn-add-entry")[0],e=c.getElementsByClassName("date-picker")[0],f=c.getElementsByClassName("time-picker-from")[0],g=c.getElementsByClassName("time-picker-to")[0],h=c.getElementsByClassName("duration-display")[0],k=(new Date(Date.now())).toLocaleDateString().split("/");
k=k[2]+"-"+v(k[0])+"-"+v(k[1]);e.value=k;f.value="08:00:00";g.value="23:00:00";G(a.timelog,C,0,function(c){c=Fa(c);for(var d=0;d<c.length;++d){var e=a,f=c[d].date,g=c[d].timeLogObjArr,h=fa.cloneNode(!0),k=h.getElementsByClassName("list-hour")[0],m=h.getElementsByClassName("date")[0],l=h.getElementsByClassName("day-duration")[0],p=M(g);p=J(p);m.innerText=f;l.innerText=p.hour.toString()+"h "+p.minute.toString()+"m";for(f=0;f<g.length;f++)m=Wa(e,g[f]),k.appendChild(m);b.appendChild(h)}});var m={taskObj:a,
htmlRef:{panelNode:c,dayList:b,addTimeLog:d,datePicker:e,fromTimePicker:f,toTimePicker:g,durationDisplay:h}};d.addEventListener("click",function(a){Oa(m)});return c},Wa=function(a,c){var b=ha.cloneNode(!0),d=b.getElementsByClassName("time-picker-from")[0],e=b.getElementsByClassName("time-picker-to")[0],f=b.getElementsByClassName("duration")[0],g=b.getElementsByClassName("range")[0],h=b.getElementsByClassName("btn-edit-session")[0],k=b.getElementsByClassName("btn-remove-session")[0],m=Q(c.startTimeStamp,
c.endTimeStamp),l=new Date(c.startTimeStamp),n=new Date(c.endTimeStamp);g.innerText=l.toLocaleTimeString()+" - "+n.toLocaleTimeString();f.innerText=m.hour+"hr "+m.minute+"m "+m.second+"s";m=v(l.getHours())+":"+v(l.getMinutes())+":"+v(l.getSeconds());n=v(n.getHours())+":"+v(n.getMinutes())+":"+v(n.getSeconds());d.value=m;e.value=n;var q={taskObj:a,timeLogObj:c,htmlRef:{sessionHourNode:b,fromTimePicker:d,toTimePicker:e,durationTitle:f,rangeTitle:g,btnEditSession:h,btnRemoveSession:k}};d.addEventListener("change",
function(a){});h.addEventListener("click",function(a){confirm("Are you sure you want to modify this session?")});k.addEventListener("click",function(a){confirm("Are you sure you want to remove this session?")&&Pa(q)});return b},u=function(){O&&O.remove();Sa(Xa,function(a){O=a;k.appendChild(O)});D.InitTimer()},La=function(a,c){var b=document.getElementById("global-modal"),d=b.getElementsByClassName("modal-body")[0];b.getElementsByClassName("modal-title")[0].innerText=a;d.innerHTML="";d.appendChild(c);
return{ToggleModal:function(){$("#global-modal").modal("toggle")},HideModal:function(){$("#global-modal").modal("hide")},ShowModal:function(){$("#global-modal").modal("show")}}},Xa=1,O=null;u()});