window.addEventListener("load",function(){var Q=function(){return parseInt(Date.now()+10*Math.random()+1)},L=function(a){a/=1E3;var c=parseInt(a/60/60),b=parseInt(a/60%60);a=parseInt(a%60);return{hour:c,minute:b,second:a}},R=function(a,c){var b=c-a;console.assert(0<=b,b);return L(b)},x=function(a){a=a.toString();return 1===a.length?"0"+a:a},y=function(a){return JSON.parse(JSON.stringify(a))},l=null,u={},v={},M={1:{id:1,title:"Todo",createdDate:Date.now(),tasks:[]}},S={1:{id:1,title:"General Board",
createdDate:Date.now(),panels:[1]}},I={modelSettings:{id:"modelSettings",modifiedModel:null,lastModified:Date.now()},timerSettings:{id:"timerSettings",timeLogId:null,taskId:null}},k=document.getElementsByClassName("content-body")[0],Y=k.getElementsByClassName("template-board")[0],Z=k.getElementsByClassName("template-panel")[0],aa=k.getElementsByClassName("template-task")[0],ba=k.getElementsByClassName("template-sub-task")[0],ca=k.getElementsByClassName("template-timer")[0],da=k.getElementsByClassName("template-timelog-panel")[0],
ea=k.getElementsByClassName("template-timelog-session-day")[0],fa=k.getElementsByClassName("template-timelog-session-hour")[0];k.removeChild(Y);k.removeChild(Z);k.removeChild(aa);k.removeChild(ba);k.removeChild(ca);k.removeChild(da);k.removeChild(ea);k.removeChild(fa);var J=Object.freeze({task:"task",subTask:"sub-task"}),G=Object.freeze({timerSettingsId:"timerSettings",modelSettingsId:"modelSettings"}),h=Object.freeze({taskStorageId:"task.json",timelogStorageId:"timelog.json",settingStorageId:"setting.json",
boardStorageId:"board.json",panelStorageId:"panel.json"}),m=Object.freeze({OnAll:"all",OnEdit:"edit",OnRemove:"remove",OnAdd:"add"}),wa=function(){var a=null,c=function(){return utils.parseQueryString(window.location.hash).access_token},b=function(a){null==l&&(l={},l["task.json"]={filename:"task.json",content:v},l["timelog.json"]={filename:"timelog.json",content:u},l["setting.json"]={filename:"setting.json",content:I},l["board.json"]={filename:"board.json",content:S},l["panel.json"]={filename:"panel.json",
content:M},C(0,function(c){r.ToggleSnack("Dropbox initialized!");a&&a(!0)}))},d=function(a,b){console.assert(a);var d=document.getElementById("files"),e=a.length;a.forEach(function(a){var f=document.createElement("li");f.innerHTML=a.name;d.appendChild(f);a='{"path": "/'+a.name+'"}';$.ajax({url:"https://content.dropboxapi.com/2/files/download",type:"POST",dataType:"json",headers:{Authorization:"Bearer "+c(),"Dropbox-API-Arg":a}}).done(function(a){console.log(a);null==l&&(l={});"task.json"===a.filename?
(l["task.json"]=a,v=a.content):"timelog.json"===a.filename?(l["timelog.json"]=a,u=a.content):"setting.json"===a.filename?(l["setting.json"]=a,I=a.content):"board.json"===a.filename?(l["board.json"]=a,S=a.content):"panel.json"===a.filename&&(l["panel.json"]=a,M=a.content);--e;0==e&&(w(),b&&b(!0))}).fail(function(a){console.log("error",a);b&&b(!1)})})},e=function(c){a.filesListFolder({path:""}).then(function(a){a=a.entries;0===a.length?b(c):d(a,c)})["catch"](function(a){console.error(a);c&&c(!1)})},
f=function(c,b,d){console.assert(-1<Object.values(h).indexOf(c));var e="/"+c,g=JSON.stringify(b);a.filesUpload({path:e,contents:g,mode:"overwrite"}).then(function(a){console.log(a);d&&d(!0)})["catch"](function(a){console.log(a);console.log("retrying.......");setTimeout(function(){f(c,b,d)},2E3)})},g=function(a,c){var b=!0;null==l?b=!1:Object.values(l).length!=Object.values(h).length&&(b=!1);1==b?f(a,l[a],c):c&&c(!1)};if(c())document.getElementById("authed-section").style.display="block",a=new Dropbox.Dropbox({accessToken:c()}),
e(function(a){a?r.ToggleSnack("Local database updated!"):r.ToggleSnack("Local database update failed!")});else{document.getElementById("pre-auth-section").style.display="block";a=new Dropbox.Dropbox({clientId:"1xc4d9cf123830a"});var p=a.getAuthenticationUrl("https://produktiewe.github.io/");document.getElementById("authlink").href=p}var C=function(a,c){var b=Object.values(h),d=b[a];a<b.length?(a+=1,g(d,function(b){b?console.log("remote file updated successfully --\x3e",d):console.log("remote update failed --\x3e",
d);C(a,c)})):c&&c()};return{UpdateLocalStorage:e,UpdateRemoteStorage:g,UpdateAllRemoteStorage:C}}(),E=function(){var a=null,c=null,b=null,d=null,e=null,f=0,g=function(a,b){b===m.OnEdit&&a.id===c.id&&H(a.timelog,D,0,function(b){console.log("timerstate updated");c=a;d=b;f=N(b)})},p=function(a){K(G.timerSettingsId,function(b){b||console.log("no timer settings found!");a&&a(b)})},C=function(){if(a&&c&&b&&e&&d){var g=b.getElementsByClassName("timer-task-title")[0],p=b.getElementsByClassName("timer-task-session-time")[0],
va=b.getElementsByClassName("timer-task-total-time")[0],h=Date.now(),k=a.startTimeStamp,n=R(k,h);h=L(f+(h-k));g.innerText=c.title;p.innerText=n.hour.toString()+":"+n.minute.toString()+":"+n.second.toString();va.innerText=h.hour.toString()+":"+h.minute.toString()+":"+h.second.toString();setTimeout(C,200)}},ha=function(p,t){console.assert(p);console.assert(t);console.assert(null===a);console.assert(null===c);console.assert(null===d);console.assert(null===e);var ua=t.id;z(G.timerSettingsId,"taskId",
p.id,K,O,function(e){e?(console.log("taskId added to app settings successfully"),z(G.timerSettingsId,"timeLogId",ua,K,O,function(e){e?(console.log("timeLogId added to app settings successfully"),H(p.timelog,D,0,function(e){b=xa(p);a=t;c=p;d=e;f=N(e);r.ToggleSnack("Timer started");k.appendChild(b);setTimeout(C,200)})):(r.ToggleSnack("Timer start failed: 0"),console.log("timeLogId added to app settings failed!"),n())})):(r.ToggleSnack("Timer start failed: 1"),console.log("taskId added to app settings failed!"),
n())});e=ya(h.taskStorageId,m.OnAll,g)},l=function(){var b=Date.now();clearTimeout(C);z(a.id,"endTimeStamp",b,D,za,function(a){a?(console.log("set endTimeStamp success!"),n(),w()):console.log("set endTimeStamp faield!")})},n=function(){z(G.timerSettingsId,"timeLogId",null,K,O,function(a){a?console.log("timeLogId - cleaned sucess!"):console.log("timeLogId - cleaned failed!")});z(G.timerSettingsId,"taskId",null,K,O,function(a){a?console.log("taskId - cleaned sucess!"):console.log("taskId - cleaned failed!")});
e&&(Aa(h.taskStorageId,e),e=null);b&&k.contains(b)&&k.removeChild(b);d=b=c=a=null;f=0};return{InitTimer:function(){b&&k.removeChild(b);p(function(a){a?a.taskId&&a.timeLogId?ia([a.taskId,a.timeLogId],[q,D],null,0,function(a){var b=a[0];a=a[1];b&&a?ha(b,a):n()}):(a.taskId||a.timeLogId)&&n():console.log("error timerSettings not found!")})},StartTimer:function(a,b){ha(a,b)},StopTimer:function(){l()},IsRunning:function(a){p(function(b){b?a&&a(b.timeLogId&&b.taskId):a&&a(!1)})}}}(),F=Object.freeze(function(){var a=
{};a[h.taskStorageId]=[];a[h.timelogStorageId]=[];a[h.settingStorageId]=[];a[h.boardStorageId]=[];a[h.panelStorageId]=[];return a}()),Aa=function(a,c){console.assert(F);console.assert(-1<Object.values(h).indexOf(a));var b=F[a];console.assert(b instanceof Array);for(var d=0;d<b.length;)c===b[d].id?(b.splice(d,1),d=0):d+=1},ya=function(a,c,b){console.assert(F);console.assert(-1<Object.values(h).indexOf(a));console.assert(-1<Object.values(m).indexOf(c));console.assert("function"===typeof b);var d=Q();
F[a].push({id:d,eventType:c,remoteStorageId:a,cb:b});return d},A=function(a,c,b){console.assert(F);console.assert(-1<Object.values(h).indexOf(a));console.assert(-1<Object.values(m).indexOf(c));wa.UpdateRemoteStorage(a,function(b){b?(r.ToggleSnack("Remote storage updated"),console.log("remote storage updated --\x3e",a)):(r.ToggleSnack("Remote storage update failed!"),console.log("remote storage update failed! --\x3e",a))});setTimeout(function(){console.assert(F);console.assert(-1<Object.values(h).indexOf(a));
console.assert(-1<Object.values(m).indexOf(c));var d=F[a];console.assert(d instanceof Array);for(var e=0;e<d.length;e++){var f=d[e];f.eventType!==c&&f.eventType!==m.OnAll||f.cb(b,c)}},2)},H=function(a,c,b,d,e){console.assert(Number.isInteger(b));console.assert(a instanceof Array);console.assert("function"===typeof c);e instanceof Array||(e=[]);b<a.length?c(a[b],function(f){e.push(f);b+=1;H(a,c,b,d,e)}):d&&d(e)},ia=function(a,c,b,d,e){console.assert(Number.isInteger(d));console.assert(a instanceof
Array);console.assert(c instanceof Array);console.assert(a.length==c.length);b instanceof Array||(b=[]);if(d<a.length)(0,c[d])(a[d],function(f){b.push(f);d+=1;ia(a,c,b,d,e)});else e(b)},ja=function(a,c){console.assert(a instanceof Array);console.assert("function"===typeof c);for(var b=0;b<a.length;b++)c(a[b])},T=function(a,c,b,d,e,f){console.assert("string"===typeof c);console.assert("function"===typeof d);console.assert("function"===typeof e);d(a,function(a){if(a){console.assert(a[c]instanceof Array);
var d=a[c],g=d.indexOf(b);-1<g&&d.splice(g,1);e(a,function(a){f&&f(a)})}else f&&f(!1)})},U=function(a,c,b,d,e,f){console.assert("string"===typeof c);console.assert("function"===typeof d);console.assert("function"===typeof e);d(a,function(a){a?(console.assert(a[c]instanceof Array),a[c].push(b),e(a,function(a){f&&f(a)})):f&&f(!1)})},z=function(a,c,b,d,e,f){console.assert("string"===typeof c);console.assert("function"===typeof d);console.assert("function"===typeof e);d(a,function(a){a?(console.assert(c in
a),a[c]=b,e(a,function(a){f&&f(a)})):f&&f(!1)})},K=function(a,c){console.assert(-1<Object.values(G).indexOf(a));var b=y(I[a]);c&&c(b)},O=function(a,c){I[a.id]=y(a);c&&c(!0);A(h.settingStorageId,m.OnEdit,I[a.id])},Ba=function(a,c){var b=y(S[a]);c&&c(b)},q=function(a,c){var b=y(v[a]);c&&c(b)},V=function(a,c){q(a,function(b){b.type===J.task&&(ja(b.timelog,ka),ja(b.subtasks,V));delete v[a];c&&c(!0);A(h.taskStorageId,m.OnRemove,!0)})},B=function(a,c){null===a.doneDate&&1==a.done?a.doneDate=Date.now():
(a.doneDate=null,a.done=!1);v[a.id]=y(a);c&&c(!0);A(h.taskStorageId,m.OnEdit,v[a.id])},Ca=function(a,c){la(a,J.subTask,function(a){c&&c(a)})},Da=function(a,c){la(a,J.task,function(a){c&&c(a)})},la=function(a,c,b){console.assert(-1<Object.values(J).indexOf(c));console.assert(a);var d=Q();a={id:d,title:a,done:!1,doneDate:null,type:c,createdDate:Date.now(),timelog:[],subtasks:[]};c==J.subTask&&delete a.subtasks;v[d]=a;b&&b(v[d]);A(h.taskStorageId,m.OnAdd,v[d])},D=function(a,c){var b=y(u[a]);c&&c(b)},
ka=function(a,c){delete u[a];c&&c(!0);A(h.timelogStorageId,m.OnRemove,!0)},za=function(a,c){var b=a.startTimeStamp,d=a.endTimeStamp;d&&b&&(a.duration=R(b,d));u[a.id]=y(a);c&&c(!0);A(h.timelogStorageId,m.OnEdit,u[a.id])},Ea=function(a,c,b){var d=Q(),e=null;b&&(e=b);u[d]={id:d,startTimeStamp:a,endTimeStamp:e,duration:null};c&&c(u[d]);A(h.timelogStorageId,m.OnAdd,u[d])},Fa=function(a){var c={},b=[];a.sort(function(a,b){return b.startTimeStamp-a.startTimeStamp});for(var d=0;d<a.length;++d){var e=a[d],
f=(new Date(Date.now())).toDateString(),g=(new Date(e.startTimeStamp)).toDateString();f=g===f?"Today":g;f in c?c[f].push(e):(c[f]=[e],b.push({date:f,timeLogObjArr:c[f]}))}return b},Ga=function(a,c,b,d){var e="validated";if(b>c){for(d=0;d<a.length;++d){var f=a[d];if(f.startTimeStamp<b&&f.endTimeStamp>b||f.startTimeStamp<c&&f.endTimeStamp>c||c<f.endTimeStamp&&b>f.endTimeStamp||c<f.startTimeStamp&&b>f.startTimeStamp)e=new Date(f.endTimeStamp),e=(new Date(f.startTimeStamp)).toLocaleString()+" - "+e.toLocaleString()+
"\n"}"validated"!=e&&(e="Conflict with: "+e)}else e="End time must be greater than start time.";return e},N=function(a){console.assert(a instanceof Array);for(var c=0,b=0;b<a.length;b++){var d=a[b],e=d.startTimeStamp;d=d.endTimeStamp;null!=d&&(e=d-e,console.assert(0<=e),c+=e)}return c},ma=function(a,c){M[a.id]=a;c&&c(!0);A(h.panelStorageId,m.OnEdit,!0)},W=function(a,c){var b=y(M[a]);c&&c(b)},na=function(a,c,b,d){Ea(a,function(a){a?(console.log("timelog creation success"),U(b,"timelog",a.id,q,B,function(b){b?
(console.log("timelog added to task successfully!"),d&&d(a)):(console.log("timelog added to task failed!"),d&&d(null))})):(console.log("timelog creation failed!"),d&&d(null))},c)},Ha=function(a){var c=a.taskObj.id;T(a.panelId,"tasks",c,W,ma,function(a){a?(console.log("edit panel success"),V(c,function(a){a?console.log("task remove success!"):console.log("task remove failed!");w()})):(console.log("edit panel failed"),w())})},pa=function(a){var c=a.taskObj.id,b=a.htmlRef.inpSubTasktitle.value,d=a.htmlRef.taskNode.getElementsByClassName("list-sub-tasks")[0];
b&&""!=b&&Ca(b,function(b){b?U(c,"subtasks",b.id,q,B,function(e){e?(e=oa(b,c),d.appendChild(e),a.htmlRef.inpSubTasktitle.value="",console.log("edit task to add subtask success")):console.log("edit task to add subtask failed!")}):console.log("add subtask failed")})},qa=function(a){var c=a.taskObj;a=a.htmlRef.inpTaskTitle;c.title!=a.value&&""!=a.value&&z(c.id,"title",a.value,q,B,function(a){a?console.log("edit task title success!"):console.log("edit task title failed!")});""==a.value&&(a.value=c.title);
a.disabled=!0},Ia=function(a){var c=a.htmlRef.inpTaskDoneChkbox.checked;z(a.taskObj.id,"done",c,q,B,function(a){a?(!0===c&&r.ToggleSnack("Task done - "+(new Date(Date.now())).toLocaleTimeString()),console.log("checked task success!")):console.log("checked task failed!")})},Ja=function(a){var c=a.id;E.IsRunning(function(b){b?(console.log("A timer is already running."),r.ToggleSnack("A timer is already running.")):(b=Date.now(),na(b,null,c,function(b){b?E.StartTimer(a,b):console.assert(!1)}))})},X=
function(a){q(a.taskObj.id,function(a){a&&E.IsRunning(function(b){b?r.ToggleSnack("This action is not allowed while timer is still running."):(b=Ka(a),La("Task: "+a.title,b).ShowModal())})})},Ma=function(a){var c=a.subTaskObj.id;T(a.taskId,"subtasks",c,q,B,function(a){a?(console.log("edit task successful!"),V(c,function(a){a?console.log("remove subtask successful!"):console.log("remove subtask failed!");w()})):(w(),console.log("edit task failed!"))})},Na=function(a){var c=a.htmlRef.inpSubtaskDoneCheck.checked;
q(a.subTaskObj.id,function(a){a.done=c;B(a,function(a){a?console.log("checked subtask success!"):console.log("checked subtask failed!")})})},ra=function(a){var c=a.subTaskObj;a=a.htmlRef.inpSubtaskTitle;c.title!=a.value&&""!=a.value&&z(c.id,"title",a.value,q,B,function(a){a?console.log("edit sub task title success!"):console.log("edit sub task failed!")});""==a.value&&(a.value=c.title);a.disabled=!0},ta=function(a){var c=a.htmlRef.inpAddTask.value,b=a.htmlRef.panelNode.getElementsByClassName("list-tasks")[0],
d=a.panelObj.id;""!=c&&null!=c&&Da(c,function(c){console.assert(c);U(d,"tasks",c.id,W,ma,function(e){e?(e=sa(c,d),b.appendChild(e),a.htmlRef.inpAddTask.value="",console.log("add task successful!")):console.log("add task failed!")})})},Oa=function(a){var c=a.taskObj,b=a.htmlRef.fromTimePicker,d=a.htmlRef.toTimePicker,e=a.htmlRef.datePicker.value.split("-");b=b.value.split(":");d=d.value.split(":");var f=new Date;f.setYear(e[0]);f.setMonth(e[1]-1);f.setDate(e[2]);f.setHours(b[0]);f.setMinutes(b[1]);
b[2]&&f.setSeconds(b[2]);f=f.valueOf();var g=new Date;g.setYear(e[0]);g.setMonth(e[1]-1);g.setDate(e[2]);g.setHours(d[0]);g.setMinutes(d[1]);d[2]&&g.setSeconds(d[2]);g=g.valueOf();H(c.timelog,D,0,function(b){b?(b=Ga(b,f,g),"validated"===b?na(f,g,c.id,function(b){b&&(w(),X(a))}):alert(b)):console.log("Add new timelog failed!")})},Pa=function(a){var c=a.timeLogObj,b=a.taskObj;ka(c.id,function(d){d?(console.log("timelog remove success!"),T(b.id,"timelog",c.id,q,B,function(b){b?(console.log("timelog id removed from task success!"),
w(),X(a)):console.assert(!1)})):console.log("timelog remove failed!")})},Sa=function(a,c){var b=null;Ba(a,function(d){if(d){b=Qa(d);for(var e=0;e<d.panels.length;e++)Ra(d.panels[e],a,function(a){a?b.appendChild(a):console.assert(!1)})}c&&c(b)})},Ra=function(a,c,b){var d=null,e=null;W(a,function(f){if(f){d=Ta(f,c);e=d.getElementsByClassName("list-tasks")[0];for(var g=0;g<f.tasks.length;g++)Ua(f.tasks[g],a,function(a){a?e.appendChild(a):console.assert(!1)})}b&&b(d)})},Ua=function(a,c,b){var d=null,
e=null;q(a,function(f){if(f){d=sa(f,c);e=d.getElementsByClassName("list-sub-tasks")[0];for(var g=0;g<f.subtasks.length;g++)Va(f.subtasks[g],a,function(a){a?e.appendChild(a):console.assert(!1)})}b&&b(d)})},Va=function(a,c,b){var d=null;q(a,function(a){a&&(d=oa(a,c));b&&b(d)})},Qa=function(a){var c=Y.cloneNode(!0),b=c.getElementsByClassName("title-board")[0],d=c.getElementsByClassName("btn-add-panel")[0];c.getElementsByClassName("input-add-panel");b.innerText=a.title;d.addEventListener("click",function(a){});
return c},Ta=function(a,c){var b=Z.cloneNode(!0),d=b.getElementsByClassName("title-panel")[0],e=b.getElementsByClassName("btn-add-task")[0],f=b.getElementsByClassName("input-add-task")[0],g=b.getElementsByClassName("btn-remove-panel")[0];d.innerText=a.title;var h={panelObj:a,boardId:c,htmlRef:{panelNode:b,title:d,inpAddTask:f,btnRemovePanel:g}};document.addEventListener("keypress",function(a){13===event.keyCode&&document.activeElement===f&&ta(h)});e.addEventListener("click",function(a){ta(h)});g.addEventListener("click",
function(a){});return b},sa=function(a,c){var b=aa.cloneNode(!0),d=b.getElementsByClassName("btn-move-task")[0],e=b.getElementsByClassName("btn-remove-task")[0],f=b.getElementsByClassName("btn-add-subtask")[0],g=b.getElementsByClassName("btn-start-timer")[0],h=b.getElementsByClassName("btn-open-timelog")[0],k=b.getElementsByClassName("input-task-checkbox-done")[0],l=b.getElementsByClassName("input-task-title")[0],m=b.getElementsByClassName("input-subtask-title")[0],n=b.getElementsByClassName("span-total-time")[0],
q=b.getElementsByClassName("span-on-going-timer")[0];l.value=a.title;k.checked=a.done;H(a.timelog,D,0,function(a){a&&(a=N(a),a=L(a),n.innerText=a.hour+"hr "+a.minute+"m")});var t={taskObj:a,panelId:c,htmlRef:{taskNode:b,btnMoveTask:d,btnRemoveTask:e,btnAddSubTask:f,btnStartTimer:g,btnAddCustomTime:h,inpTaskDoneChkbox:k,inpTaskTitle:l,inpSubTasktitle:m,sTotalTime:n,sOnGoingTime:q}};document.addEventListener("keypress",function(a){13===event.keyCode&&document.activeElement===m&&pa(t);13===event.keyCode&&
document.activeElement===l&&qa(t)});document.addEventListener("click",function(a){event.target===l?l.disabled=!1:(l.disabled=!0,qa(t))});d.addEventListener("click",function(a){});e.addEventListener("click",function(a){E.IsRunning(function(a){a?r.ToggleSnack("This action is not allowed while timer is still running."):confirm("Are you sure you want to remove this task?")&&Ha(t)})});f.addEventListener("click",function(a){pa(t)});g.addEventListener("click",function(b){Ja(a)});h.addEventListener("click",
function(a){X(t)});k.addEventListener("click",function(a){Ia(t)});return b},oa=function(a,c){var b=ba.cloneNode(!0),d=b.getElementsByClassName("btn-remove-subtask")[0],e=b.getElementsByClassName("input-subtask-checkbox-done")[0],f=b.getElementsByClassName("input-subtask-title")[0];f.value=a.title;e.checked=a.done;var g={subTaskObj:a,taskId:c,htmlRef:{subTaskNode:b,btnRemoveSubtask:d,inpSubtaskDoneCheck:e,inpSubtaskTitle:f}};document.addEventListener("keypress",function(a){13===event.keyCode&&document.activeElement===
f&&ra(g)});document.addEventListener("click",function(a){event.target===f?f.disabled=!1:(f.disabled=!0,ra(g))});d.addEventListener("click",function(a){E.IsRunning(function(a){a?r.ToggleSnack("This action is not allowed while timer is still running."):confirm("Are you sure you want to remove this sub-task?")&&Ma(g)})});e.addEventListener("click",function(a){Na(g)});return b},xa=function(a){a=ca.cloneNode(!0);a.getElementsByClassName("timer-task-title");a.getElementsByClassName("timer-task-session-time");
a.getElementsByClassName("timer-task-total-time");a.getElementsByClassName("btn-stop-timer")[0].addEventListener("click",function(a){E.StopTimer()});return a},Ka=function(a){var c=da.cloneNode(!0),b=c.getElementsByClassName("list-day")[0],d=c.getElementsByClassName("btn-add-entry")[0],e=c.getElementsByClassName("date-picker")[0],f=c.getElementsByClassName("time-picker-from")[0],g=c.getElementsByClassName("time-picker-to")[0],h=c.getElementsByClassName("duration-display")[0],k=(new Date(Date.now())).toLocaleDateString().split("/");
k=k[2]+"-"+x(k[0])+"-"+x(k[1]);e.value=k;f.value="08:00:00";g.value="23:00:00";H(a.timelog,D,0,function(c){c=Fa(c);for(var d=0;d<c.length;++d){var e=a,f=c[d].date,g=c[d].timeLogObjArr,h=ea.cloneNode(!0),k=h.getElementsByClassName("list-hour")[0],l=h.getElementsByClassName("date")[0],m=h.getElementsByClassName("day-duration")[0],p=N(g);p=L(p);l.innerText=f;m.innerText=p.hour.toString()+"h "+p.minute.toString()+"m";for(f=0;f<g.length;f++)l=Wa(e,g[f]),k.appendChild(l);b.appendChild(h)}});var l={taskObj:a,
htmlRef:{panelNode:c,dayList:b,addTimeLog:d,datePicker:e,fromTimePicker:f,toTimePicker:g,durationDisplay:h}};d.addEventListener("click",function(a){Oa(l)});return c},Wa=function(a,c){var b=fa.cloneNode(!0),d=b.getElementsByClassName("time-picker-from")[0],e=b.getElementsByClassName("time-picker-to")[0],f=b.getElementsByClassName("duration")[0],g=b.getElementsByClassName("range")[0],h=b.getElementsByClassName("btn-edit-session")[0],k=b.getElementsByClassName("btn-remove-session")[0],l=R(c.startTimeStamp,
c.endTimeStamp),m=new Date(c.startTimeStamp),n=new Date(c.endTimeStamp);g.innerText=m.toLocaleTimeString()+" - "+n.toLocaleTimeString();f.innerText=l.hour+"hr "+l.minute+"m "+l.second+"s";l=x(m.getHours())+":"+x(m.getMinutes())+":"+x(m.getSeconds());n=x(n.getHours())+":"+x(n.getMinutes())+":"+x(n.getSeconds());d.value=l;e.value=n;var q={taskObj:a,timeLogObj:c,htmlRef:{sessionHourNode:b,fromTimePicker:d,toTimePicker:e,durationTitle:f,rangeTitle:g,btnEditSession:h,btnRemoveSession:k}};d.addEventListener("change",
function(a){});h.addEventListener("click",function(a){confirm("Are you sure you want to modify this session?")});k.addEventListener("click",function(a){confirm("Are you sure you want to remove this session?")&&Pa(q)});return b},w=function(){P&&P.remove();Sa(Xa,function(a){P=a;k.appendChild(P)});E.InitTimer()},La=function(a,c){var b=document.getElementById("global-modal"),d=b.getElementsByClassName("modal-body")[0];b.getElementsByClassName("modal-title")[0].innerText=a;d.innerHTML="";d.appendChild(c);
return{ToggleModal:function(){$("#global-modal").modal("toggle")},HideModal:function(){$("#global-modal").modal("hide")},ShowModal:function(){$("#global-modal").modal("show")}}},r=function(a){var c=document.getElementById("snackbar"),b=[],d=!1,e=function(){c.className=c.className.replace("show","");d=!1;0<b.length&&(c.innerText=b.shift(),c.className="show",setTimeout(e,2E3),d=!0)};return{ToggleSnack:function(a){b.push(a);!1===d&&setTimeout(e,1)}}}(),Xa=1,P=null;w()});